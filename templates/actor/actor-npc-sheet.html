<form class="{{cssClass}} {{actor.type}} backgroundstyle fabulaultima-actor-sheet" autocomplete="off">

  <!-- Start Sheet Header -->
  <header class="sheet-header">
    <img class="profile-img" src="{{actor.img}}" data-edit="img" title="{{actor.name}}" />
    <div class="header-fields">
      <div class="grid grid-6col">
        <h1 class="charname grid-span-4 flex-between">
          <input name="name" type="text" value="{{actor.name}}" placeholder="Name" class="resource-input-charname auto-shrink" />
        </h1>

        <!-- Level -->
        <span class="levelup">
          <label class="resource-label-sm" for="system.level.value">
            <i class="fa-solid fa-chart-simple icon"></i>{{localize 'FU.LevelAbbr'}}
          </label>
            <input type="text" name="system.level.value" value="{{system.level.value}}" data-dtype="Number" class="resource-input" />
        </span>

        <!-- Rank -->
        <span class="levelup">
          <label class="resource-label-sm" for="system.isChampion.value" data-tooltip="Champion Rank" aria-describedby="tooltip">
            <i class="fa-solid fa-feather-pointed icon"></i>{{localize 'FU.Rank'}}
          </label>
          <label class="elite">
            <i class="fas fa-check-square {{#if system.isElite.value}}checked{{/if}}" data-name="system.isElite.value"></i>
          </label>
          <input type="text" name="system.isChampion.value" value="{{system.isChampion.value}}" data-dtype="Number" class="resource-input" />
        </span>
      </div>

      <!-- Point Bars -->
      <div class="grid grid-3col">
        <!-- HP -->
        <div class="resource flex-group-center align-left">
          <label for="system.resources.hp.max" class="resource-label" data-tooltip="Hit Points" aria-describedby="tooltip">
            <span class="resource-label">
              <i class="fa-solid fa-heart icon"></i>{{localize 'FU.HealthAbbr'}}
            </span>
          </label>
          <div class="bar bar-progress">
            <div class="bar-progress-bar bar-hp" style="width: 100%;"></div>
            <span class="bar-value"></span>
          </div>
          <div class="resource-content flexrow flex-center flex-between align-center">
            <input class="resource-current-input bar-start" type="text" name="system.resources.hp.value" value="{{system.resources.hp.value}}" data-dtype="Number" />
            <span class="resource-middle-input bar-middle" data-tooltip="{{localize 'FU.HealthAbbr'}}<br>Current: {{system.resources.hp.value}}<br>Crisis: {{half system.resources.hp.max}}
              <br>Mod: {{system.resources.hp.bonus}} <br>Max: {{system.resources.hp.max}}" aria-describedby="tooltip">
              <i class="fa-solid fa-caret-up"></i>
            </span>
            <input class="resource-max-input bar-end" type="text" name="system.resources.hp.max" value="{{system.resources.hp.max}}" data-dtype="Number" disabled="{{system.resources.hp.max}}" data-tooltip="{{localize 'FU.HealthPoints'}}<br>Current: {{system.resources.hp.value}}<br>Mod: {{system.resources.hp.bonus}} <br>Max: {{system.resources.hp.max}}" aria-describedby="tooltip"/>
          </div>
        </div>

        <!-- MP -->
        <div class="resource flex-group-center align-left">
          <label for="system.resources.mp.value" class="resource-label" data-tooltip="Mind Points" aria-describedby="tooltip">
            <span class="resource-label">
              <i class="fa-solid fa-wand-magic-sparkles icon"></i>{{localize 'FU.MindAbbr'}}
            </span>
          </label>
          <div class="bar bar-progress" data-tooltip="MP" aria-describedby="tooltip">
            <div class="bar-progress-bar bar-mp" style="width: 100%;"></div>
            <span class="bar-value"></span>
          </div>
          <div class="resource-content flexrow flex-center flex-between align-center">
            <input class="resource-current-input bar-start" type="text" name="system.resources.mp.value" value="{{system.resources.mp.value}}" data-dtype="Number" class="resource-input bar-start" />
            <span class="resource-middle-input bar-middle" data-tooltip="{{localize 'FU.MindPoints'}}<br>Current: {{system.resources.mp.value}}<br>Mod: {{system.resources.mp.bonus}} <br>Max: {{system.resources.mp.max}}" aria-describedby="tooltip">
              <i class="fa-solid fa-caret-up"></i>
            </span>
            <input class="resource-max-input bar-end" type="text" name="system.resources.mp.max" value="{{system.resources.mp.max}}" data-dtype="Number" disabled="{{system.resources.mp.max}}" />
          </div>
        </div>

        <!-- Creature Rank-->
        <div class="Type flex-group-center levelup creature">
          <label for="system.resources.creature.value" class="resource-label creature-type" data-tooltip="Creature Type" aria-describedby="tooltip">
            <div class="resource-label">
              <i class="fa-solid fa-chart-simple icon"></i>{{localize 'FU.CreatureType'}}  
            </div>
          </label>
          <div class="resource-content flexrow flex-center flex-between buttons-inc">
            <select value="{{system.creature.value}}" name="system.creature.value" class="resource-input creature-input">
              {{#select system.creature.value}}
                <option value="beast">{{localize 'FU.Beast'}}</option>
                <option value="construct">{{localize 'FU.Construct'}}</option>
                <option value="demon">{{localize 'FU.Demon'}}</option>
                <option value="elemental">{{localize 'FU.Elemental'}}</option>
                <option value="monster">{{localize 'FU.Monster'}}</option>
                <option value="plant">{{localize 'FU.Plant'}}</option>
                <option value="undead">{{localize 'FU.Undead'}}</option>
                <option value="humanoid">{{localize 'FU.Humanoid'}}</option>
                <option value="custom">{{localize 'FU.Custom'}}</option>
              {{/select}}
            </select>
          </div>
        </div>        
      </div>
    </div>
  </header>

  <!-- Start Extra Section -->
  <div class="grid grid-4col" style="align-items: baseline;">
    
    <!-- Ultima Points -->
    <div class="resource flex-group-center">
      <label for="system.resources.fp.value">
        <span class="resource-label">
          <i class="fa-solid fa-crystal-ball icon"></i>{{localize 'FU.UltimaPoints'}}
        </span>
      </label>
      <div class="buttons-inc">
        <button class="decrement-button" data-resource="fp" data-action="decrease"><i class="fas fa-minus"></i></button>
        <input type="text" name="system.resources.fp.value" value="{{system.resources.fp.value}}" data-dtype="Number" id="fp-input" class="fp-resource-input" />
        <button class="increment-button" data-resource="fp" data-action="increase"><i class="fas fa-plus"></i></button>
      </div>
    </div>

    <!-- DEF -->
    <div class="resource flex-group-center">
      <label for="system.derived.def.value" class="resource-label rollable roll-init" data-label="{{localize 'FU.Defense'}}" data-type="def"></label>
        <span class="rollable resource-label">
          <i class="fa-solid fa-shield icon"></i>{{localize 'FU.DefenseAbbr'}}
        </span>
      </label>
      <div class="resource-content  flex-center">
        <input class="resource-input" id="def-input"type="text" name="system.derived.def.value" value="{{system.derived.def.value}}" data-dtype="Number" data-tooltip="{{localize 'FU.Defense'}}<br>Current: {{system.derived.def.value}}<br>Mod: {{system.derived.def.bonus}}" aria-describedby="tooltip" disabled>
      </div>
    </div>

    <!-- MDEF -->
    <div class="resource flex-group-center">
      <label for="system.derived.mdef.value" class="resource-label rollable roll-init" data-label="{{localize 'FU.MagicDefense'}}" data-type="mdef"></label>
        <span class="rollable resource-label">
          <i class="fa-solid fa-shield-halved icon"></i>{{localize 'FU.MagicDefenseAbbr'}}
        </span>
      </label>
      <div class="resource-content  flex-center">
        <input class="resource-input" id="mdef-input" type="text" name="system.derived.mdef.value" value="{{system.derived.mdef.value}}" data-dtype="Number" data-tooltip="{{localize 'FU.MagicDefense'}}<br>Current: {{system.derived.mdef.value}}<br>Mod: {{system.derived.mdef.bonus}}" aria-describedby="tooltip" disabled>
      </div>
    </div>

    <!-- Initiative -->
    <div class="resource-content  flex-group-center">
      <div class="resource-label" data-label="Initiative">
        <span class="rollable resource-label rollinit" data-type="rollinit" data-roll-type="rollinit" data-roll="1d@attributes.dex.current + 1d@attributes.ins.current + @derived.init.value">
          <i class="fa-solid fa-clock icon"></i>{{localize 'FU.IsInitiative'}}
        </span>
      </div>
      <div class="resource-content flex-center">
        <input class="resource-input" id="init-input" type="text" name="system.derived.init.value" value="{{system.derived.init.value}}" data-dtype="Number" data-tooltip="{{localize 'FU.Initiative'}}<br>Current: {{system.derived.init.value}}<br>Bonus: {{system.derived.init.bonus}}" aria-describedby="tooltip"  disabled>
      </div>
    </div>

    <!-- Resource 1 -->
    <div class="resource-content flex-group-center">
      <div class="name-input">
        <input type="text" name="system.resources.rp1.name" title="{{localize 'FU.ResourcePoints'}}" value="{{system.resources.rp1.name}}" data-dtype="String" placeholder="Resource 1" class="resource-label" />
      </div>
      <div class="buttons-inc">
        <button class="increment-button" data-resource="rp1" data-action="decrease"><i class="fas fa-minus"></i></button>
        <input type="text" name="system.resources.rp1.value" data-tooltip="Current: {{system.resources.rp1.value}}<br>Step: X<br>Max: X<br>" aria-describedby="tooltip" value="{{system.resources.rp1.value}}" data-dtype="Number" id="rp1-input" class="resource-input" />
        <button class="increment-button" data-resource="rp1" data-action="increase"><i class="fas fa-plus"></i></button>
      </div>
    </div>

    <!-- Resource 2 -->
    <div class="resource-content flex-group-center">
      <div class="name-input">
        <input type="text" name="system.resources.rp2.name" title="{{localize 'FU.ResourcePoints'}}" value="{{system.resources.rp2.name}}" data-dtype="String" placeholder="Resource 2" class="resource-label" />
      </div>
      <div class="buttons-inc">
        <button class="increment-button" data-resource="rp2" data-action="decrease"><i class="fas fa-minus"></i></button>
        <input type="text" name="system.resources.rp2.value" data-tooltip="Current: {{system.resources.rp2.value}}<br>Step: X<br>Max: X<br>" aria-describedby="tooltip" value="{{system.resources.rp2.value}}" data-dtype="Number" id="rp2-input" class="resource-input" />
        <button class="increment-button" data-resource="rp2" data-action="increase"><i class="fas fa-plus"></i></button>
      </div>
    </div>
    
    <!-- Resource 3 -->
    <div class="resource-content flex-group-center">
      <div class="name-input">
        <input type="text" name="system.resources.rp3.name" title="{{localize 'FU.ResourcePoints'}}" value="{{system.resources.rp3.name}}" data-dtype="String" placeholder="Resource 3" class="resource-label" />
      </div>
      <div class="buttons-inc">
        <button class="increment-button" data-resource="rp3" data-action="decrease"><i class="fas fa-minus"></i></button>
        <input type="text" name="system.resources.rp3.value" data-tooltip="Current: {{system.resources.rp3.value}}<br>Step: X<br>Max: X<br>" aria-describedby="tooltip" value="{{system.resources.rp3.value}}" data-dtype="Number" id="rp3-input" class="resource-input" />
        <button class="increment-button" data-resource="rp3" data-action="increase"><i class="fas fa-plus"></i></button>
      </div>
    </div>
    

    <!-- Roll Check -->
    <div class="resource flex-group-center">
      <span class="rollable rollcheck" data-type="rollcheck" data-roll-type="rollcheck" data-roll="1d@attributes.dex.current + 1d@attributes.ins.current + @derived.init.value">
        <label for="system.derived.init.value" class="resource-label">
          <span class="rollable resource-label">
            <i class="fa-solid fa-dice icon"></i>{{localize 'FU.RollCheck'}}
          </span>
        </label>
      </span>
      <div class="resource-content flexrow flex-center flex-between buttons-inc">
        <div class="">
          <select value="{{system.rollInfo.attributes.primary.value}}" name="system.rollInfo.attributes.primary.value" class="resource-input">
            {{#select system.rollInfo.attributes.primary.value}}
            <option value="attributes.dex.current">{{localize 'FU.AttributeDexAbbr'}}</option>
            <option value="attributes.ins.current">{{localize 'FU.AttributeInsAbbr'}}</option>
            <option value="attributes.mig.current">{{localize 'FU.AttributeMigAbbr'}}</option>
            <option value="attributes.wlp.current">{{localize 'FU.AttributeWlpAbbr'}}</option>
            {{/select}}
          </select>
        </div>
        <span class="roll-check-option" data-tooltip="Customize Roll" aria-describedby="tooltip"><i class="fas fa-plus"></i></span>
        <div class="">
          <select value="{{system.rollInfo.attributes.secondary.value}}" name="system.rollInfo.attributes.secondary.value" class="resource-input">
            {{#select system.rollInfo.attributes.secondary.value}}
            <option value="attributes.dex.current">{{localize 'FU.AttributeDexAbbr'}}</option>
            <option value="attributes.ins.current">{{localize 'FU.AttributeInsAbbr'}}</option>
            <option value="attributes.mig.current">{{localize 'FU.AttributeMigAbbr'}}</option>
            <option value="attributes.wlp.current">{{localize 'FU.AttributeWlpAbbr'}}</option>
            {{/select}}
          </select>
        </div>
      </div>
    </div>
  </div>
  {{!-- End Extra Section --}}

  <div class="grid grid-9col">
    {{#affinity system.affinity}}
      <div class="flex-group-center resource-content">
        <label>
          <span class="resource-label">
            <i class="{{icon}} icon-aff"></i>
            <br>{{localize label}}
          </span>
        </label>
        <select value="{{value}}" name="{{name}}" class="resource-input select-dropdown">
          {{#select value}}
            <option value="NA">-</option>
            <option value="VU">VU</option>
            <option value="RS">RS</option>
            <option value="IM">IM</option>
            <option value="AB">AB</option>
          {{/select}}
        </select>
      </div>
    {{/affinity}}
  </div>
  {{!-- End Affinity Section --}}

  {{!-- Sheet Tab Navigation --}}
  <nav class="sheet-tabs tabs" data-group="primary">
    {{!-- Default tab is specified in actor-sheet.mjs --}}
    <a class="item tab-style" data-tab="attributes">{{localize 'FU.Stats'}}</a>
    <a class="item tab-style" data-tab="items">{{localize 'FU.Items'}}</a>
    <a class="item tab-style" data-tab="spells">{{localize 'FU.Spells'}}</a>
    <a class="item tab-style" data-tab="behavior">{{localize 'FU.Behavior'}}</a>
    <a class="item tab-style" data-tab="effects" data-tooltip="{{localize 'FU.Effects'}}" aria-describedby="tooltip"><i class="fa-solid fa-wand-magic-sparkles"></i></a>
    <a class="item tab-style" data-tab="settings" data-tooltip="{{localize 'FU.Settings'}}" aria-describedby="tooltip"><i class="fa-solid fa-bars"></i></a>
  </nav>
  {{!-- Sheet Body --}}
  <section class="sheet-body">
    {{!-- Owned Features Tab --}}
    <div class="tab features" data-group="primary" data-tab="attributes">
      <section class="grid grid-3col">
        <aside class="sidebar flex-group-center">
          {{!-- The grid classes are defined in scss/global/_grid.scss. To use,
          use both the "grid" and "grid-Ncol" class where "N" can be any number
          from 1 to 12 and will create that number of columns. --}}
          <div class="abilities flexcol">
            {{#each system.attributes as |attribute key|}}
              <div class="ability resource-content flexrow flex-group-center">
                <label for="system.attributes.{{key}}.base" class="resource-label flexlarge align-left" data-label="{{attribute.label}}">
                  <span class="resource-label">{{attribute.label}}</span>
                </label>
                <select class="resource-input" data-dtype="Number" value="{{attribute.base}}" name="system.attributes.{{key}}.base" >
                  {{#select attribute.base}}
                    <option value="6">d6</option>
                    <option value="8">d8</option>
                    <option value="10">d10</option>
                    <option value="12">d12</option>
                  {{/select}}
                </select>
                <span class="ability-mod">  
                  <span class="resource-label">{{ attribute.current }}</span>
                </span>
              </div>
            {{/each}}
          </div>
        </aside>
      <section class="npc-border-col grid-span-2 "> 
        <li class="flexrow flex-group-center npc-desc">
          <label for="system.traits.value" class="resource-label ">{{localize 'FU.Traits'}}</label>
          <input class="traitdesc flex3" type="text" name="system.traits.value" value="{{system.traits.value}}" placeholder="Typical Traits" data-dtype="String">
        </li>
        <section class="flex2 npc-desc">
            {{editor system.description target="system.description" rollData=rollData button=true owner=owner editable=editable}}
        </section>
      </section>




      <section class="grid-span-3 align-right">
        <ol class="items-list">
          <li class="item flexrow items-header">
            <div class="item-name">{{localize 'FU.Name'}}</div>
            <div class="item-equipped">{{localize 'FU.FavoriteStatus'}}</div>
            <div class="item-controls">
              <a
                class="item-control item-create"
                title="{{localize 'FU.isFavored'}}"
                data-type="weapon"
                ><i class="fa-solid fa-sort"></i>{{localize 'FU.Sort'}}</a
              >
            </div>
          </li>
          {{#each items as |item id|}}
            {{#if (and item.system.isFavored.value)}}
                <li class="item" data-item-id="{{item._id}}">
                  <div class="flexrow">
                    <div class="item-name click-item individual-trapping-and-description">
                      <div class="item-image">
                        <a class="rollable" data-roll-type="item">
                          <div class="item-image-wrap">
                            <img src="{{item.img}}" title="{{item.name}}" class="item-image-res" />
                          </div>
                        </a>
                      </div>
                      <h4>
                        {{item.name}} {{#if item.isMartial.value}}
                        <span class="is-martial">âœ¦</span>
                        {{/if}}
                      </h4>
                    </div>
                    <div class="item-equipped">

                    </div>
                    <div class="item-controls">
                      <a
                      class="item-control item-favored"
                      {{#if item.system.isFavored.value}}
                      title="{{localize 'FU.Unfavorite'}}"
                      {{else}}
                      title="{{localize 'FU.Favorite'}}"
                      {{/if}}
                    >
                      {{#if item.isFavored.value}}
                      <i class="fa-regular fa-star"></i>
                      {{else}}
                      <i class="fa-solid fa-star"></i>
                      {{/if}}
                    </a>
                      <a class="item-control item-edit" title="{{localize 'FU.WeaponEdit'}}"
                        ><i class="fas fa-edit"></i
                      ></a>
                    </div>
                  </div>
                  <div class="individual-description">{{ item.quality.value }}</div>
                </li>
              {{/if}}
          {{/each}}
        </ol>
      </section>

    </div>

    {{!-- Handlebar partial template inclusion --}}
    {{!-- Biography Tab --}}
    <div class="tab biography" data-group="primary" data-tab="description">
      {{!-- If you want TinyMCE editors to output inline rolls when rendered,
      you need to pass the actor's roll data to the rollData property. --}}
      {{editor system.biography target="system.biography" rollData=rollData
      button=true owner=owner editable=editable}}
    </div>
    {{!-- Owned Items Tab --}}
    <div class="tab items" data-group="primary" data-tab="items">
      {{> "systems/fabulaultima/templates/actor/parts/actor-items.html"}}
    </div>
    <div class="tab spells" data-group="primary" data-tab="spells">
      {{> "systems/fabulaultima/templates/actor/parts/actor-spells.html"}}
    </div>
    {{!-- Active Effects Tab --}}
    <div class="tab behavior" data-group="primary" data-tab="behavior">
      {{> "systems/fabulaultima/templates/actor/parts/actor-behavior.html"}}
    </div>
    {{!-- Active Effects Tab --}}
    <div class="tab effects flexcol" data-group="primary" data-tab="effects">
      {{> "systems/fabulaultima/templates/actor/parts/actor-effects.html"}}
    </div>
    {{!-- Settings Tab --}}
    <div class="tab effects flexcol" data-group="primary" data-tab="settings">
      {{> "systems/fabulaultima/templates/actor/parts/actor-settings.html"}}
    </div>
  </section>
</form>